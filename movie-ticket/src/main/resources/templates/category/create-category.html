<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="en">
<head th:replace="~{layout::head}">
</head>
<body>
<div class="container">
    <header th:replace="~{layout::header}"></header>
    <section>
        <div class="row my-5 dashboard-admin">
            <div class="col-lg-3 sidebar-admin">
                <div th:replace="~{layout::sidebar-admin}"></div>
            </div>
            <div class="col-lg-9 ps-5 table-dashboard category">
                <h3>Thêm mới danh mục phim</h3>
                <form class="creat-item my-4" th:object="${category}" method="post">
                    <div class="row mb-3">
                        <label for="inputNameCategory" class="col-sm-2 col-form-label">Tên danh mục</label>
                        <div class="col-sm-10">
                            <input th:field="*{nameCategory}" type="text" class="form-control" id="inputNameCategory"
                                   required>
                        </div>
                    </div>
                    <div class="row mb-3">
                        <label class="col-sm-2 col-form-label">Hình ảnh danh mục</label>
                        <div class="col-sm-10">
                            <div>
                                <input class="form-control" type="file" id="image" multiple accept=".jpg, .jpeg, .png">
                                <input name="image2" type="hidden" id="image-result" th:field="*{image}" required>
                            </div>
                        </div>
                    </div>
                    <div id="preview-image-add" class="row mb-3" style="display: none">
                        <div class="col-sm-2"><label class="col-form-label">Hình ảnh xem trước</label></div>
                        <div class="col-sm-10">
                            <div id="image-preview-container2" class="img-thumbnail">
                                <img id="image-preview" th:src="*{image}" alt="image chose" src=""/>
                            </div>
                        </div>
                    </div>
                    <div class="d-flex justify-content-center">
                        <button type="submit" class="btn btn-primary">Thêm mới</button>
                    </div>
                </form>
            </div>
        </div>
    </section>
</div>
<footer th:replace="~{layout::footer}"></footer>
<script>
    $(document).ready(function () {
        $("#image").change(function () {
            const formData = new FormData();
            let file = $("#image")[0].files[0];
            formData.append('file', file);
            $.ajax({
                url: "/upload/image",
                type: "POST",
                data: formData,
                success: function (data) {
                    $("#image-result").val(data.url);
                    $("#image-result").attr("src",data.url);
                },
                processData: false,
                contentType: false
            });
        });
    });
</script>
</body>
</html>